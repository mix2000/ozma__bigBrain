---
order: 1
title: Баланс плата
---

Очень интересная идея -- получается что-то вроде карманного устройства для отображения баланса карт в реальном времени. Вот план по этапам и необходимым компонентам для старта.

---

### **1\. Цель устройства**

Устройство запрашивает баланс банковской карты по API и отображает его на экране. Работает автономно, использует eSIM и GPS (если нужно геопозиционирование/авторизацию по региону).

---

### **2\. Что нужно для реализации**

#### **А. Аппаратная часть**

1. **Микроконтроллер (MCU)**:

   -  **ESP32** -- оптимальный выбор: есть Wi-Fi, Bluetooth, поддержка экрана, низкое энергопотребление.

   -  Либо **Raspberry Pi Pico W** -- если нужен мощнее, но без GSM/eSIM.

2. **GSM/4G-модуль с eSIM**:

   -  **SIM7000G / SIM7600** -- поддерживают LTE CAT-M/NB-IoT, работают с eSIM.

   -  Важно проверить, поддерживает ли оператор eSIM для IoT.

3. **Дисплей**:

   -  OLED 1.3" (128x64) или e-Ink дисплей -- для низкого энергопотребления.

   -  Подключение по I2C или SPI.

4. **Батарея и питание**:

   -  Li-Po аккумулятор 3.7V + зарядка (например, через TP4056).

   -  Power management через **TP4056**, **LDO**, и батарейный держатель.

5. **Корпус (опционально)**:

   -  Можно сделать 3D-печать или собрать вручную.

#### **Б. Программная часть**

1. **Прошивка**:

   -  Язык: **C++ (Arduino) / MicroPython / CircuitPython**.

   -  Сеть: подключение к LTE / Wi-Fi.

   -  Запросы по API через HTTPS.

2. **Библиотеки**:

   -  `TinyGSM` (для GSM-модулей),

   -  `Adafruit_SSD1306` (для OLED),

   -  `ArduinoHttpClient` или `WiFiClientSecure` (для HTTPS API).

3. **API провайдера баланса карты**:

   -  Например, **Тинькофф**, **Сбер**, **Monobank** (в Украине) -- нужен доступ к открытому API или авторизация по токену.

   -  **Либо через proxy-сервер**, который будет обращаться к банку и отдавать данные на устройство.

---

### **3\. Архитектура**

```
[ eSIM-модуль ] ←→ [ ESP32 MCU ] ←→ [ OLED экран ]
        ↑                ↑
  LTE-интернет      REST API запросы (баланс)
```

---

### **4\. Этапы реализации**

1. **Выбрать API**: найти способ получать баланс карты (официально или обходным путём через бекенд).

2. **Собрать минимальный прототип**:

   -  Подключить дисплей к ESP32.

   -  Настроить eSIM-модуль и соединение.

3. **Реализовать API-запрос и отображение баланса**.

4. **Оптимизировать энергопотребление** (спящий режим, периодический запрос).

5. **Создать корпус** и сделать тест в реальной среде.

---

### **5\. Дополнительно**

-  **Безопасность**: токены и авторизация не должны быть в открытом виде.

-  **Обновление прошивки**: стоит предусмотреть возможность OTA-обновления.





Отлично, тогда сделаем акцент на компактность, энергоэффективность и будущую поддержку eSIM. Вот оптимальный план и список компонентов для MVP-версии, которую можно носить с собой как карточку.

---

## **Цель**

Мини-устройство размером с кредитную карту (85×54 мм), которое:

-  делает HTTPS-запросы к API баланса,

-  отображает результат на дисплее,

-  сначала работает по Wi-Fi, позже -- по eSIM (LTE),

-  питается от аккумулятора и работает автономно.

---

## **1\. Подходящие компоненты**

### **A. Микроконтроллер**

**ESP32 WROOM / ESP32-S3 Mini**

-  Wi-Fi (и Bluetooth),

-  Компактный форм-фактор,

-  Много библиотек, поддержка Arduino,

-  Потребление в спящем режиме \~10µA.

**Размеры**: от 25×18 мм (Mini версия).

---

### **B. Дисплей (размер с карту)**

**1\.54" e-Ink дисплей (GDEH0154D67 / Waveshare)**

-  200x200, 1.54", работает по SPI,

-  Без подсветки (низкое энергопотребление),

-  Идеально подходит под формат карты, можно вставить в пластиковый корпус.

**Альтернатива**: OLED 1.5" 128x128 (но выше расход энергии).

---

### **C. Питание**

**Ли-По аккумулятор 400–500 mAh + зарядка TP4056**

-  До 2–3 дней работы (зависит от режима сна и частоты обновления).

-  Можно встроить microUSB/USB-C для зарядки.

-  **Step-up/step-down преобразователь** для стабилизации 3.3V.

---

### **D. Связь**

**На старте**: Wi-Fi (через ESP32).\
**Позже**: модуль с eSIM:

-  **SIM7000G** (CAT-M1/NB-IoT + GPS),

-  Поддерживает eSIM, SPI/UART интерфейс.

> Важно: при переходе к eSIM потребуется изменить прошивку и питание (модуль потребляет 200–300 мА при соединении).

---

### **E. Корпус**

-  Можно взять пластиковый держатель карты или напечатать на 3D-принтере.

-  Основная цель -- толщина не больше 4–6 мм.

---

## **2\. План действий**

### **Этап 1. Прототип с Wi-Fi**

1. **Собрать ESP32 + e-Ink дисплей** на макетке.

2. **Подключить Wi-Fi** и сделать запрос к тестовому API.

3. **Вывести данные на экран**.

4. Реализовать **режим сна и пробуждение по таймеру** (например, раз в 30 минут).

### **Этап 2. Реальный API баланса**

1. Найти API (например, от банка или свой proxy-сервер).

2. Обеспечить **авторизацию через токен**.

3. Вывести реальные данные о карте на экран.

### **Этап 3. Миниатюризация**

1. Перейти на **пайку компонентов на плате**.

2. Уменьшить схему, вплоть до печатной платы по размеру карты.

3. Вставить в корпус.

### **Этап 4. Поддержка eSIM**

1. Добавить SIM7000G и настроить LTE.

2. Переписать часть логики на работу с GSM.

3. Обеспечить fallback: Wi-Fi при отстутствии LTE.

---

## **Итоговый список компонентов (на старте)**

| Название          | Модель/вариант                |
|-------------------|-------------------------------|
| Микроконтроллер   | ESP32-WROOM или ESP32-S3 Mini |
| Дисплей           | 1\.54" e-Ink SPI (200x200)    |
| Батарея           | Li-Po 400–500 mAh             |
| Зарядка           | TP4056 с microUSB             |
| Понижающий модуль | AMS1117 или аналог            |
| Корпус            | 3D-печать / карта-держатель   |
| Плата/макетка     | Под пайку/тесты               |

---

Хочешь, я сделаю Fritzing-схему подключения дисплея к ESP32 и базовый скетч для теста?