---
order: 4
title: Отказаустойчивость
---

Обеспечение отказоустойчивости сервиса -- это комбинация архитектурных решений, мониторинга, масштабирования и резервирования. Разберу основные подходы:

---

### **1\. Инфраструктура и отказоустойчивость на уровне развертывания**

#### **1\.1 Контейнеризация и оркестрация**

-  **Docker + Kubernetes** -- позволяет управлять сервисами, автоматически перезапускать упавшие поды, балансировать нагрузку.

-  **Nomad** -- альтернатива Kubernetes, если нужна более легковесная оркестрация.

#### **1\.2 Облачные решения**

-  Использование **AWS/GCP/Azure** с автоматическим масштабированием и балансировкой нагрузки.

-  Развертывание в **Multi-AZ (зоны доступности)**, чтобы при падении одной зоны сервис оставался доступным.

#### **1\.3 Репликация БД**

-  **Master-Slave или Multi-Master репликация** (PostgreSQL, MySQL, MongoDB) -- если одна БД падает, запросы переключаются на реплику.

-  **Read Replica** для балансировки нагрузки чтения.

---

### **2\. Архитектурные паттерны**

#### **2\.1 Load Balancing (Балансировка нагрузки)**

-  **Nginx + Keepalived** -- для отказоустойчивости на уровне API.

-  **Cloud Load Balancers (AWS ELB, GCP Load Balancer)** -- управляемая балансировка в облаке.

#### **2\.2 Circuit Breaker (Размыкатель цепи)**

-  **Istio + Envoy (Service Mesh)** -- перехватывает запросы и перенаправляет их, если сервис недоступен.

-  **Hystrix (Netflix OSS)** -- размыкатель цепи, который предотвращает каскадные сбои.

#### **2\.3 Кэширование для снижения нагрузки**

-  **Redis / Memcached** -- кэширование часто запрашиваемых данных.

-  **CDN (Cloudflare, AWS CloudFront)** -- кэширование статического контента.

---

### **3\. Резервирование и мониторинг**

#### **3\.1 Логирование и мониторинг**

-  **Prometheus + Grafana** -- мониторинг метрик сервиса.

-  **ELK Stack (Elasticsearch + Logstash + Kibana)** -- логирование запросов и ошибок.

-  **Sentry** -- сбор и анализ ошибок.

#### **3\.2 Резервное копирование**

-  Автоматические **бэкапы БД** (Snapshot, Point-in-Time Recovery).

-  **Replica storage** -- дублирование данных в нескольких локациях.

#### **3\.3 Автооткат в случае неудачных деплоев**

-  **Canary Deployment** -- выкатываем обновление на небольшую часть пользователей.

-  **Blue-Green Deployment** -- переключение между старой и новой версией без простоев.

---

### **4\. Масштабирование и отказоустойчивость API**

-  **Horizontal Scaling (горизонтальное масштабирование)** -- добавляем новые инстансы при увеличении нагрузки.

-  **Feature Flags (Unleash, LaunchDarkly)** -- если новая фича вызывает сбои, её можно выключить без отката всего релиза.

---

Если говорить конкретно про твой стек (NestJS + React + Angular):

1. **NestJS** -- добавить **circuit breaker** (например, `@nestjs/bull` для очередей и `@nestjs/terminus` для health checks).

2. **React / Angular** -- предусмотреть обработку ошибок API и фолбэк-контент.

3. **API Gateway (например, Kong/Nginx)** -- для балансировки и кэширования.

Что конкретно планируешь защищать?